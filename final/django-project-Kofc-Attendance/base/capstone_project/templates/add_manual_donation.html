{% extends 'base.html' %}
{% load static %}

{% block title %}
Knights of Columbus - Add Manual Donation
{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/donations-style.css' %}?v={% now 'U' %}">
<div class="background">
    <h1>Add Manual Donation</h1>
    <p>Enter details for donations made offline (e.g., cash, check).</p>
</div>
<div class="container">
    <section class="hero">
        <div class="content">
            <h1>Record Offline Donations</h1>
            <p>Help track manual contributions to support our mission and ensure accurate records.</p>
        </div>
    </section>
    
    <section class="donation-form">
        <h2>Manual Donation Input</h2>
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
        {% endif %}
        {% if form.errors %}
        <div class="alert alert-danger">
            <ul>
                {% for field in form %}
                {% for error in field.errors %}
                <li>{{ field.label }}: {{ error }}</li>
                {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <!-- Static Donation Thermometer (replace values dynamically if needed) -->
        <div class="donation-thermometer">
            <p>Our Goal: ₱100,000</p>
            <div class="progress-bar">
                <div class="progress" style="width: 50%;"></div> <!-- Example: 50% filled -->
            </div>
            <p>Raised: ₱50,000</p>
        </div>
        <form method="post" enctype="multipart/form-data" id="donationForm">
            {% csrf_token %}
            <fieldset class="form-section">
                <legend>Donor Information</legend>
                <div class="form-group">
                    <label for="id_first_name">First Name:</label>
                    <input type="text" id="id_first_name" name="first_name" value="{{ form.first_name.value|default:'' }}" 
                           pattern="[A-Z][a-zA-Z]*" oninput="validateName(this)">
                    <span class="warning" id="first_name_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_middle_initial">Middle Initial:</label>
                    <input type="text" id="id_middle_initial" name="middle_initial" value="{{ form.middle_initial.value|default:'' }}" 
                           pattern="[A-Z]" oninput="validateMiddleInitial(this)" maxlength="1">
                    <span class="warning" id="middle_initial_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_last_name">Last Name:</label>
                    <input type="text" id="id_last_name" name="last_name" value="{{ form.last_name.value|default:'' }}" 
                           pattern="[A-Z][a-zA-Z]*( [A-Z][a-zA-Z]*)*" oninput="validateName(this)">
                    <span class="warning" id="last_name_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_email">Email:</label>
                    <input type="email" id="id_email" name="email" value="{{ form.email.value|default:'' }}" 
                           oninput="validateEmail(this)">
                    <span class="warning" id="email_warning"></span>
                </div>
            </fieldset>
            <fieldset class="form-section">
                <legend>Donation Details</legend>
                <div class="form-group">
                    <label for="id_amount">Amount (PHP):</label>
                    <input type="number" id="id_amount" name="amount" value="{{ form.amount.value|default:'' }}" required min="1" step="0.01"
                           oninput="validateAmount(this)">
                    <span class="warning" id="amount_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_donation_date">Donation Date:</label>
                    <input type="date" id="id_donation_date" name="donation_date" value="{{ form.donation_date.value|default:'' }}" required
                           oninput="validateDate(this)">
                    <span class="warning" id="donation_date_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_event">Direct Donation To (Optional):</label>
                    {{ form.event }}
                    <span class="warning" id="event_warning"></span>
                </div>
                <div class="form-group">
                    <label for="id_receipt">Receipt (Optional):</label>
                    <input type="file" id="id_receipt" name="receipt" onchange="validateReceipt(this)">
                    <span class="warning" id="receipt_warning"></span>
                </div>
                <div class="form-group">
                    {{ form.donate_anonymously.label_tag }}
                    <div class="anonymous-row">
                        {{ form.donate_anonymously }}
                        {{ form.donate_anonymously.errors }}
                        <p class="explanation-text">
                            <strong>Privacy Note:</strong> By selecting 'Donate Anonymously', your personal details (such as name and email) will not be publicly displayed or shared with anyone outside our organization. Your donation will still count toward our totals and support our mission, but it won't be linked to you in any visible way. This option is ideal if you prefer privacy. Note: We may still need your contact info for internal records or tax purposes, but it won't be disclosed.
                        </p>
                    </div>
                </div>
            </fieldset>
            <button type="submit" class="btn btn-primary">Submit Donation</button>
        </form>
        <p class="manual-donation-text">
            <a href="{% url 'donations' %}" class="manual-donation-link">Back to Donations</a>
        </p>
    </section>
</div>
<script src="{% static 'js/payment.js' %}?v={% now 'U' %}"></script>
{% endblock %}